<div *ngIf="isParent && !loading" [class]="isParent ? '' : ' mt-4'">
    <div class="parent-detailchild font-inter">
      <app-parent-child-header-simple *ngIf="isParent"
        [title]="'CALENDAR_PAGE.CALENDAR' | translate"
      >
      </app-parent-child-header-simple>

      <div class="body container-fluid">
        <div class="main-information">
          <full-calendar [options]="calendarOptions"></full-calendar>
          <div class="main-information">
            <h5 class="title-body">
              {{ 'CALENDAR_PAGE.UPCOMING_EVENTS_HOLIDAYS' | translate }}
            </h5>
            <div class="profile-info-grid" *ngIf="getUpcomingEvents().length > 0">
              <div class="profile-info-card" *ngFor="let item of getUpcomingEvents()"
                   [ngClass]="{'bg-danger bg-opacity-10': isHoliday(item)}"
                   (click)="isEvent(item) ? goToEventDetail(item) : null"
                   [style.cursor]="isEvent(item) ? 'pointer' : 'default'">
                <div>
                  <div class="info-title" [class.text-danger]="isHoliday(item)">
                    <span *ngIf="isHoliday(item)">ðŸŽ‰ </span>{{ item.name }}
                  </div>
                  <div class="info-desc"> {{ getItemDateTime(item) | date:'MMM d, y' }} <span *ngIf="isEvent(item)">{{ 'CALENDAR_PAGE.AT' | translate }} {{ getItemDateTime(item) | date:'shortTime' }}</span> </div>
                  <div class="info-desc"> {{ isEvent(item) ? item.type : ('CALENDAR_PAGE.HOLIDAY' | translate) }} </div>
                </div>
              </div>
            </div>
            <div class="card card-general shadow-sm" *ngIf="getUpcomingEvents().length == 0">
              <div class="text-center">
                <div class="card-body text-center text-muted py-4">
                  <i class="bi bi-calendar-x icon-3x mb-3 opacity-25"></i>
                  <p class="mb-0">{{ 'CALENDAR_PAGE.NO_UPCOMING_EVENTS' | translate }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
</div>

<div *ngIf="!isParent"  [class]="isParent ? '' : 'container-fluid mt-4'">
  <app-title-page
  [title]="'CALENDAR_PAGE.CALENDAR' | translate"
  [breadcrumbs]="[{label: ('CALENDAR_PAGE.DASHBOARD' | translate), url: '/dashboard'}, {label: ('CALENDAR_PAGE.CALENDAR' | translate)}]">
  </app-title-page>
  <div class="container-fluid">
  <div class="row">
    <div class="col-lg-8">
      <div class="card">
        <div class="card-body">
          <full-calendar [options]="calendarOptions"></full-calendar>
        </div>
      </div>
    </div>

    <div class="col-lg-4">
      <div class="card card-general shadow-sm selected-day">
        <div class="card-header">
          <i class="bi bi-check2-circle"></i>
          <h5 class="mb-0">{{ 'CALENDAR_PAGE.SELECTED_DATES' | translate }}</h5>
        </div>
        <div class="card-body">
          <p class="mb-1 selected-event_day"><strong>{{ 'CALENDAR_PAGE.DATE' | translate }}</strong> {{ selectedDate | date:'fullDate' }}</p>
          <div *ngIf="getEventsForDate(selectedDate).length > 0; else noEvents">
            <div *ngFor="let event of getEventsForDate(selectedDate)" class="mb-2 p-2 bg-light rounded">
              <strong class="selected-event_day">{{ event.name }}</strong><br>
              <small class="selected-event_time">{{ event.type }} - {{ event.time | date:'shortTime' }}</small>
            </div>
          </div>
          <ng-template #noEvents>
            <p class="mb-0 selected-event_time">{{ 'CALENDAR_PAGE.NO_EVENTS_SCHEDULED' | translate }}</p>
          </ng-template>
        </div>
      </div>

      <div class="card card-general shadow-sm mt-3 card-upcoming_calendar">
        <div class="card-header">
          <i class="bi bi-clock"></i>
          <h5 class="mb-0">{{ 'CALENDAR_PAGE.UPCOMING_EVENTS_HOLIDAYS' | translate }}</h5>
        </div>
        <div class="card-body">
          <div *ngIf="getUpcomingEvents().length > 0; else noUpcoming">
            <div *ngFor="let item of getUpcomingEvents()"
                 class="mb-3 p-2 border-start border-3"
                 [ngClass]="isHoliday(item) ? 'border-danger bg-danger bg-opacity-10' : 'border-primary'">
              <strong class="d-block name" [class.text-danger]="isHoliday(item)">
                <span *ngIf="isHoliday(item)">ðŸŽ‰ </span>{{ item.name }}
              </strong>
              <small class="text-muted d-block time">
                {{ getItemDateTime(item) | date:'MMM d, y' }}
                <span *ngIf="isEvent(item)"> {{ 'CALENDAR_PAGE.AT' | translate }} {{ getItemDateTime(item) | date:'shortTime' }}</span>
              </small>
              <small class="text-muted type">{{ isEvent(item) ? item.type : ('CALENDAR_PAGE.HOLIDAY' | translate) }}</small>
            </div>
          </div>
          <ng-template #noUpcoming>
            <p class="mb-0 text-muted">{{ 'CALENDAR_PAGE.NO_UPCOMING_EVENTS_SHORT' | translate }}</p>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
  </div>
</div>

<!-- Event Details Modal -->
<div class="modal fade" [class.show]="selectedEvent" [style.display]="selectedEvent ? 'block' : 'none'" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content" *ngIf="selectedEvent">
      <div class="modal-header">
        <h5 class="modal-title">{{ selectedEvent.name }}</h5>
        <button type="button" class="btn-close" (click)="closeEventModal()"></button>
      </div>
      <div class="modal-body">
        <p><strong>{{ 'CALENDAR_PAGE.TYPE' | translate }}</strong> {{ selectedEvent.type }}</p>
        <p><strong>{{ 'CALENDAR_PAGE.DATE' | translate }}</strong> {{ selectedEvent.time | date:'fullDate' }}</p>
        <p><strong>{{ 'CALENDAR_PAGE.TIME' | translate }}</strong> {{ selectedEvent.time | date:'shortTime' }}</p>
        <p *ngIf="selectedEvent.description"><strong>{{ 'CALENDAR_PAGE.DESCRIPTION' | translate }}</strong> {{ selectedEvent.description }}</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="custom-btn-2 btn-cancel-2" (click)="closeEventModal()">{{ 'CALENDAR_PAGE.CLOSE' | translate }}</button>
      </div>
    </div>
  </div>
</div>
<div class="modal-backdrop fade" [class.show]="selectedEvent" *ngIf="selectedEvent" (click)="closeEventModal()"></div>

<!-- Date Events Modal -->
<div class="modal fade" [class.show]="showDateEventsModal" [style.display]="showDateEventsModal ? 'block' : 'none'" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">{{ 'CALENDAR_PAGE.EVENTS_ON' | translate }} {{ selectedDate | date:'fullDate' }}</h5>
        <button type="button" class="btn-close" (click)="closeDateEventsModal()"></button>
      </div>
      <div class="modal-body">
        <div *ngFor="let holiday of selectedDateHolidays" class="mb-3 p-3 border rounded bg-danger bg-opacity-10">
          <h6 class="mb-2 text-danger">ðŸŽ‰ {{ holiday.name }}</h6>
          <p class="mb-0"><strong>{{ 'CALENDAR_PAGE.HOLIDAY' | translate }}</strong></p>
        </div>
        <div *ngFor="let event of selectedDateEvents" class="mb-3 p-3 border rounded" (click)="selectedEvent = event; showDateEventsModal = false" style="cursor: pointer;">
          <h6 class="mb-2">{{ event.name }}</h6>
          <p class="mb-1"><strong>{{ 'CALENDAR_PAGE.TYPE' | translate }}</strong> {{ event.type }}</p>
          <p class="mb-0"><strong>{{ 'CALENDAR_PAGE.TIME' | translate }}</strong> {{ event.time | date:'shortTime' }}</p>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="custom-btn-2 btn-cancel-2" (click)="closeDateEventsModal()">{{ 'CALENDAR_PAGE.CLOSE' | translate }}</button>
      </div>
    </div>
  </div>
</div>
<div class="modal-backdrop fade" [class.show]="showDateEventsModal" *ngIf="showDateEventsModal" (click)="closeDateEventsModal()"></div>

<!-- No Events Modal -->
<div class="modal fade" [class.show]="showNoEventsModal" [style.display]="showNoEventsModal ? 'block' : 'none'" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">{{ 'CALENDAR_PAGE.NO_EVENTS' | translate }}</h5>
        <button type="button" class="btn-close" (click)="closeNoEventsModal()"></button>
      </div>
      <div class="modal-body text-center">
        <i class="bi bi-calendar-x icon-3x mb-3 opacity-25"></i>
        <p>{{ 'CALENDAR_PAGE.NO_EVENT_ON_DATE' | translate }} {{ selectedDate | date:'fullDate' }}</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="custom-btn-2 btn-cancel-2" (click)="closeNoEventsModal()">{{ 'CALENDAR_PAGE.CLOSE' | translate }}</button>
      </div>
    </div>
  </div>
</div>
<div class="modal-backdrop fade" [class.show]="showNoEventsModal" *ngIf="showNoEventsModal" (click)="closeNoEventsModal()"></div>