<div class="container mt-4">
  <app-title-page 
    title="Add Parent" 
    subtitle="Create a new parent profile and user account"
    icon="bi bi-plus-square"
    [breadcrumbs]="breadcrumbs">
  </app-title-page>

  <div class="card card-general">
    <div class="card-header">
      <h5>Parent Information</h5>
    </div>
    <div class="card-body">
      <form (ngSubmit)="saveParent()">
        <div class="row">
          <div class="col-md-6 mb-3">
            <label class="form-label">First Name *</label>
            <input type="text" class="form-control" [(ngModel)]="newParent.firstName" name="firstName" required>
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Last Name *</label>
            <input type="text" class="form-control" [(ngModel)]="newParent.lastName" name="lastName" required>
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Email *</label>
            <input type="email" class="form-control" [(ngModel)]="newParent.email" name="email" required>
            <small class="form-text text-muted">This will be used as the login username</small>
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Password *</label>
            <input type="password" class="form-control" [(ngModel)]="newParent.password" name="password" required minlength="6">
            <small class="form-text text-muted">Minimum 6 characters</small>
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Phone Number *</label>
            <input type="text" class="form-control" [(ngModel)]="newParent.phoneNumber" name="phoneNumber" required>
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Emergency Contact</label>
            <input type="text" class="form-control" [(ngModel)]="newParent.emergencyContact" name="emergencyContact">
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Gender</label>
            <select class="form-select" [(ngModel)]="newParent.gender" name="gender">
              <option value="">Select Gender</option>
              <option value="Male">Male</option>
              <option value="Female">Female</option>
            </select>
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Date of Birth</label>
            <input type="date" class="form-control" [(ngModel)]="newParent.dateOfBirth" name="dateOfBirth">
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Work</label>
            <input type="text" class="form-control" [(ngModel)]="newParent.work" name="work" placeholder="Occupation or workplace">
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Zip Code</label>
            <input type="text" class="form-control" [(ngModel)]="newParent.zipCode" name="zipCode" placeholder="Postal code">
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Parent Type</label>
            <select class="form-select" [(ngModel)]="newParent.parentType" name="parentType">
              <option value="">Select Parent Type</option>
              <option value="Father">Father</option>
              <option value="Mother">Mother</option>
              <option value="Grandfather">Grandfather</option>
              <option value="Grandmother">Grandmother</option>
              <option value="Guardian">Guardian</option>
            </select>
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Profile Picture</label>
            <input type="file" class="form-control" (change)="onImageSelect($event)" accept="image/*">
            <img *ngIf="imagePreview" loading="lazy" [src]="imagePreview" class="mt-2 rounded" width="100" height="100" alt="Preview">
          </div>
          <div class="col-md-6 mb-3">
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" [(ngModel)]="newParent.isActive" name="isActive" id="isActive">
              <label class="form-check-label" for="isActive">
                Active Status
              </label>
            </div>
          </div>
          <div class="col-12 mb-3">
            <label class="form-label">Address</label>
            <textarea class="form-control" [(ngModel)]="newParent.address" name="address" rows="3" placeholder="Enter full address"></textarea>
          </div>
        </div>
        
        <div class="alert alert-info">
          <i class="bi bi-info-circle me-2"></i>
          <strong>Note:</strong> This will create both a parent profile and a user account with Parent role. The parent will be able to log in using their email and password.
        </div>
        
        <div class="d-flex gap-2">
          <button type="submit" class="btn btn-success btn-add-global" [disabled]="saving">
            <span *ngIf="saving" class="spinner-border spinner-border-sm me-2"></span>
            {{ saving ? 'Creating...' : 'Create Parent & Account' }}
          </button>
          <button type="button" class="btn btn-secondary btn-cancel-global" (click)="cancel()" [disabled]="saving">Cancel</button>
        </div>
      </form>
    </div>
  </div>
</div>
